КТ Дамба
задача с моделированием

Версия 1. WSGI -- 2019-11-08
Версия 2. ASGI -- 2019-11-25

проект "дамба" 
2019-11-08 .. 2019-11-22
сделать простое подмножество 

постановка:
нужна система: 
- движок, получающий, хранящий, удаляющий, и главное - исполняющий сценарии на языке, близком по логике к BPMN
- реально нужны только начало, шаг, конец
- к нему можно подключаться (пока без ключей доступа) и проходить бизнес-процесс с результатами

требования:
- новый участник подключается, получает код доступа (ключ)
- с этим ключом он может:
    - работать со схемами БП (СБП) 
	- добавлять
	- удалять
	- просматривать (наличие, список и сами схемы, в простой форме)
    - запускать исполнение СБП
	- при запуске возвращается код экземпляра исполнения (ЭСБП), 
	- по нему можно:
	    - ходить и 
	    - получать результаты 
		- пока что всё успешно, что соответствует линейной схеме
		    - но ошибки, если хочет, напр., шаг после завершения или ещё что
	    - останавливать исполнение ЭСМБП
    - выйти из системы

инструменты:
- всё на питоне, что можно
- простой сайт
    - а м.б. и просто логи в 1 версии
- ком. строка и чуток наглядности
- делаем под docker-compose, м.б. потом и k3d
- можно потом использовать и очереди типа RabbitMQ, но на 1 этапе всё как можно проще
- БД: redis/ memcache, 
    - всё равно после выхода всё стирается

язык СБП:
START имя
STEP имя 
STOP 

детали:
м.б. много скриптов одновременно
автоматизированное тестирование с очень многими экземплярами
логирование полное, штатное
доступ по REST API
везде всё в JSON

база данных:
таблицы:
- схемы, список
- схемы, шаги (для каждой)
- участники
- результаты прогонов (в т.ч. статистика)

/api/v1
/user/addme
/user/killme/uid/<uid>
/join/uid/<uid>/route/<rid>
/step/uid/<uid>/route/<rid>
/stop/uid/<uid>/route/<rid>
/addroute/uid/<uid>/steps/<#steps>
/delroute/uid/<uid>/route/<rid>
/info
/info/users
/info/user/<uid>
/info/routes
/info/route/<rid>

table users (uid, name)
table routes (rid, steps)
table sessions (sid, uid, rid, step)
    (steps: 0 = init, 999 = end)
table log (dt, event, uid, rid, what)
    events: init, adduser, deluser, addroute, delroute, startsess, stepsess, stopsess, error
results:
    [ok, error], desc=""

params: 
maxusers = 10
maxroutes = 10
maxsteps = 10
